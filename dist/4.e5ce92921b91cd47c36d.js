(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1171:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o,l,u=r(a(49)),c=r(a(21)),i=r(a(50)),s=r(a(91)),f=r(a(12)),d=r(a(135)),p=r(a(19)),m=r(a(20)),h=r(a(18)),v=r(a(74)),y=(r(a(92)),a(5)),g=a(787);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var S=(n=function(e){(0,p.default)(a,e);var t=_(a);function a(){var e;(0,f.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).resourceName="apps",e.defaultStatus=g.STORE_QUERY_STATUS,(0,s.default)(e,"allApps",o,(0,d.default)(e)),e.defaultRepo="repo-helm",(0,s.default)(e,"adjustCategory",l,(0,d.default)(e)),e}return a}(r(a(844)).default),o=(0,v.default)(n.prototype,"allApps",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,v.default)(n.prototype,"adjustCategory",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,i.default)(u.default.mark((function t(a){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.submitting(Promise.all(e.list.selectedRowKeys.map((function(t){return request.patch(e.getUrl({app_id:t}),E({},a))}))));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),n);t.default=S},1172:function(e,a,r){"use strict";var n=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(12)),l=n(r(13)),u=n(r(19)),c=n(r(20)),i=n(r(18)),s=n(r(0)),f=n(r(24)),d=n(r(1)),p=n(r(3)),m=r(801),h=n(r(293)),v=n(r(3598));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,u.default)(r,e);var a=y(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,l.default)(r,[{key:"renderTopIntro",value:function(){var e=this.props.detail;if(!(0,f.default)(e)||!("name"in e))return null;var t=e.name,a=e.description,r=e.icon;return s.default.createElement("div",{className:v.default.intro},s.default.createElement("span",{className:v.default.icon},s.default.createElement(h.default,{iconSize:48,iconLetter:t,src:r,alt:""})),s.default.createElement("div",{className:v.default.text},s.default.createElement("div",null,t),s.default.createElement("p",null,a)))}},{key:"render",value:function(){var e=this.props.onBack;return s.default.createElement("div",{className:v.default.banner},s.default.createElement("div",{className:v.default.inner},s.default.createElement("div",{className:v.default.innerContent},s.default.createElement("div",{className:(0,p.default)(v.default.shape,v.default.shape_1)}),s.default.createElement("div",{className:(0,p.default)(v.default.shape,v.default.shape_3)}),s.default.createElement("div",{className:(0,p.default)(v.default.shape,v.default.shape_4)}),this.isAppsPage?s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:v.default.leftShape_1}),s.default.createElement("div",{className:v.default.leftShape_2})):s.default.createElement("div",{className:(0,p.default)(v.default.shape,v.default.shape_2)}),s.default.createElement("div",{className:v.default.appOutline},s.default.createElement("div",{className:v.default.back},s.default.createElement("a",{className:"custom-icon",href:"#",onClick:e},s.default.createElement(m.ReactComponent,null),s.default.createElement("span",null,t("BACK")))),this.renderTopIntro()))))}},{key:"isAppsPage",get:function(){return"/apps"===location.pathname}}]),r}(s.default.PureComponent);a.default=g,g.propTypes={className:d.default.string,children:d.default.node}},1523:function(e,t,a){e.exports={categories:"sLkAf-XDwKpAfclwhXJNd",title:"_1hQ6p5Fm7hkBoy-4vFEYSt",add:"_1DcjBCaTpQADnVQvOPqM38",active:"k4hqHUc9YUVi0MX3FV7-F",hasAction:"_3q4FhIJ6NUjWg7-w_nwt5G",number:"_3ZeruO4K7XqLSP-nWdtuTh",actions:"_1LvZQRi2RWB_mCeXCI0eh_",icon:"fzACYa3WbetSt8MFjAjAh",dot:"_2TtJi5oOnBW_bFmpCZABvv"}},3596:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(109)),o=a(634),l=r(a(3597)),u=r(a(3600)),c=r(a(3602)),i=r(a(3606)),s=r(a(3608)),f=r(a(3609)),d=r(a(3613)),p=r(a(3616)),m="/apps-manage",h=[].concat((0,n.default)(p.default),[{path:m,component:i.default,routes:[{path:"".concat(m,"/store"),component:s.default,exact:!0},{path:"".concat(m,"/categories"),component:f.default,exact:!0},{path:"".concat(m,"/reviews/:type"),component:d.default,exact:!0},(0,o.getIndexRoute)({path:m,to:"".concat(m,"/store"),exact:!0}),(0,o.getIndexRoute)({path:"".concat(m,"/reviews/"),to:"".concat(m,"/reviews/unprocessed"),exact:!0}),(0,o.getIndexRoute)({path:"*",to:"/404",exact:!0})]},{path:"/apps",component:l.default,exact:!0},{path:"/apps/:appId",component:u.default,exact:!0},{path:"/apps/:appId/deploy",component:c.default,exact:!0}]);t.default=h},3597:function(e,a,r){"use strict";var n=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,l=n(r(49)),u=n(r(109)),c=n(r(21)),i=n(r(50)),s=n(r(12)),f=n(r(13)),d=n(r(19)),p=n(r(20)),m=n(r(18)),h=n(r(0)),v=n(r(3)),y=r(70),g=n(r(279)),b=r(25),E=r(638),_=n(r(1171)),S=n(r(1119)),P=r(787),O=n(r(1172)),w=n(r(1310)),A=n(r(3599));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var D=["new","all"],N=(0,y.inject)("rootStore")(o=(0,y.observer)(o=function(e){(0,d.default)(o,e);var a,r,n=k(o);function o(e){var a;return(0,s.default)(this,o),(a=n.call(this,e)).fetchApps=(0,i.default)(l.default.mark((function e(){var t,r,n,o,c,i,s,f,d,p=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},r=!(p.length>1&&void 0!==p[1])||p[1],n=a.queryParams,o=n.category,c=n.keyword,i={},c&&(i.keyword=c),o&&!D.includes(o)&&(i.category_id=o),e.next=8,a.appStore.fetchList(C(C({limit:P.STORE_APP_LIMIT,status:"active"},i),t));case 8:s=a.appStore,f=s.allApps,d=s.list,r?(f.clear(),f.replace(d.data)):f.push.apply(f,(0,u.default)(d.data));case 10:case"end":return e.stop()}}),e)}))),a.fetchMoreApps=(0,i.default)(l.default.mark((function e(){var t;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.appStore.list.page,e.next=3,a.fetchApps({page:t+1},!1);case 3:case"end":return e.stop()}}),e)}))),a.handleScroll=function(){if(a.cateRef&&a.cateRef.current&&a.appRef&&a.appRef.current){var e=(0,E.getScrollTop)(),t=a.cateRef.current.classList,r=t.contains("fixed-cates"),n=a.cateRef.current.clientHeight<a.appRef.current.clientHeight||a.cateRef.current.clientHeight<document.documentElement.clientHeight;e>=200&&!r&&n?t.add("fixed-cates"):e<200&&r&&t.remove("fixed-cates")}},a.handleClickCate=function(e,r){a.setState({tabName:t("APP_CATE_".concat(r.toUpperCase().replace(/[^A-Z]+/g,"_")),{defaultValue:r})}),a.props.rootStore.query({category:e})},a.handleSearch=function(e){a.props.rootStore.query({keyword:e})},a.appStore=new _.default,a.categoryStore=new S.default,a.cateRef=h.default.createRef(),a.appRef=h.default.createRef(),a.state={tabName:t("APP_CATE_ALL")},a}return(0,f.default)(o,[{key:"componentDidMount",value:(r=(0,i.default)(l.default.mark((function e(){var a,r,n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.categoryStore,r=a.fetchList,n=a.list,e.next=3,r({noLimit:!0});case 3:return n.data.unshift({category_id:"all",name:t("ALL"),description:"templet"}),e.next=6,this.fetchApps();case 6:window.addEventListener("scroll",this.handleScroll);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"componentDidUpdate",value:(a=(0,i.default)(l.default.mark((function e(t){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.location,t.location.search===a.search){e.next=4;break}return e.next=4,this.fetchApps();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"renderToolbar",value:function(){var e=this.appStore.list.total,a=this.queryParams.keyword;return h.default.createElement("div",{className:A.default.toolbar},h.default.createElement(b.Level,{className:A.default.level},h.default.createElement(b.LevelLeft,{className:A.default.countDesc},t("TOTAL_CATE_COUNT",{total:e})),h.default.createElement(b.LevelRight,null,h.default.createElement(b.InputSearch,{onSearch:this.handleSearch,value:a,className:A.default.search,placeholder:t("SEARCH_BY_NAME")}))))}},{key:"renderCategories",value:function(){var e=this,a=this.categoryStore.list.data,r=this.queryParams.category;return h.default.createElement("div",{className:A.default.cates,ref:this.cateRef},h.default.createElement("div",{className:A.default.group},h.default.createElement("p",{className:A.default.title},t("DISCOVER")),h.default.createElement("ul",{className:A.default.menu},h.default.createElement("li",{key:"new",className:(0,v.default)(A.default.item,(0,c.default)({},A.default.active,"new"===r)),onClick:function(){return e.handleClickCate("new")}},h.default.createElement(b.Icon,{name:"cart",size:16,type:"dark",className:A.default.icon}),h.default.createElement("span",{className:A.default.name},t("NEW_APPS"))))),h.default.createElement("div",{className:A.default.group},h.default.createElement("p",{className:A.default.title},t("APP_CATEGORY_PL")),h.default.createElement("ul",{className:A.default.menu},a.map((function(a,n){var o=a.category_id,l=a.name,u=a.description;return h.default.createElement("li",{key:o||n,className:(0,v.default)(A.default.item,(0,c.default)({},A.default.active,r===o)),onClick:function(){return e.handleClickCate(o,l)}},h.default.createElement(b.Icon,{name:"ctg-uncategorized"===o?"tag":u,size:16,type:r===o?"coloured":"dark",className:A.default.icon}),h.default.createElement("span",{className:A.default.name},t("APP_CATE_".concat(l.toUpperCase().replace(/[^A-Z]+/g,"_")),{defaultValue:l})))})))))}},{key:"render",value:function(){var e=this.appStore,a=e.list,r=e.allApps,n=a.isLoading,o=a.total,l=this.queryParams,u=l.workspace,c=l.namespace,i=l.cluster,s=this.state.tabName;return h.default.createElement("div",{className:A.default.wrapper},h.default.createElement(O.default,{className:A.default.banner},h.default.createElement("h2",{className:A.default.title},t("APP_STORE")),h.default.createElement("p",{className:A.default.desc},t("HOME_APP_STORE_DESC"))),this.renderToolbar(),h.default.createElement("div",{className:A.default.body},this.renderCategories(),h.default.createElement(w.default,{className:A.default.apps,appRef:this.appRef,title:s,apps:r.slice(),isLoading:n,total:o,onFetchMore:this.fetchMoreApps,workspace:u,namespace:c,cluster:i})))}},{key:"queryParams",get:function(){return g.default.parse(location.search.slice(1))}}]),o}(h.default.Component))||o)||o;a.default=N},3598:function(e,t,a){e.exports={banner:"BW_8lSmLA-hLKNrk6BRXn",shape:"_3TdccQC934Smh2yPqeoNb4",leftShape_1:"_1asi2ovNffaYPL3Vo_4pda",leftShape_2:"C0uI80EvC9PRDYHrDv3Ak",inner:"_2OJE6lPlidv98EgOrCRqKP",innerContent:"_12oNR-t1N6vNB6sQ-UWZJi",shape_1:"_1PIfOZWmUljK1Ljktx-x7f",shape_2:"_3z_Ib1LTRugQfO5LsgCoXy",shape_3:"_3wQXytutfLqGcJJ0yHnKcf",shape_4:"_4zd1uS-Gz0jIzz9KYpQmA",appOutline:"_1AQlv-hu_lC1E2_Ko97Gbx",back:"_3lMiKHG8yxSFc7qLDCj1DE",intro:"_2abtbDiUKvJ5ld5xdSnQb",icon:"_3RmH-cTvdIFF1qc1Ti1dUZ",text:"_2fqNqzfOiOtyfht5S_lKcN"}},3599:function(e,t,a){e.exports={wrapper:"ZoSqYOuTZbdzFk223e5e1",body:"LmPWLohaCco6MkyGQn-Cd",toolbar:"MJyYR-u6yu4GfBeUdCp7y",level:"_1MdheDdYvg_5QC9nT5tOtU",apps:"_3SFMzhxaLzdSrnGk-9ThD_",banner:"_3QE7h_JWOLoF6Ne0lY_PAe",title:"_34cB1J5uDIMUBm4tl81fkA",desc:"_2KsRTRX7iuu00LhOBLslHK",countDesc:"_6OahLmwuS1Ry2zCdcny36",search:"_1Eby5R3APXTXeWvNnNQ7Ad",cates:"_2a7R5dvJkmhjtJkz3yz4Ug",group:"_1cwIPnXKf4wE5iAoGjfhsI",menu:"_22NOVOPrvwUzVIKyGElzi7",item:"kZUz2oW6c5BkcltOfMty_",active:"_10yC4V32YRRDelQzuAEuO-",name:"_1LA0xb0S-WjGQSCK7Ibe_p",icon:"e8pEcVidnlqdIjojyDUGt"}},3600:function(e,a,r){"use strict";var n=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,l=n(r(12)),u=n(r(13)),c=n(r(19)),i=n(r(20)),s=n(r(18)),f=n(r(0)),d=n(r(16)),p=r(279),m=r(5),h=r(70),v=n(r(137)),y=r(25),g=n(r(636)),b=n(r(814)),E=n(r(862)),_=n(r(1172)),S=n(r(1471)),P=n(r(1311)),O=n(r(1321)),w=r(635),A=n(r(3601));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var C=y.Tabs.TabPanel,k=(0,h.inject)("rootStore")(o=(0,h.observer)(o=(0,w.trigger)(o=function(e){(0,c.default)(r,e);var a=R(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleTabChange=function(e){t.setState({tab:e})},t.handleBack=function(){t.routing.push("/apps")},t.handleChangeAppVersion=function(e){t.params.version=e,t.setState({selectAppVersion:e})},t.handleDeploy=function(){"system-workspace"===t.appStore.detail.isv&&"true"!==localStorage.getItem("".concat(globals.user.username,"-app-agreement"))?t.trigger("openpitrix.app.agreement",{success:t.handleLink}):t.handleLink()},t.handleLink=function(){var e="".concat(t.props.match.url,"/deploy").concat(location.search);globals.user?t.routing.push(e):location.href="/login?referer=".concat(e)},t.params=(0,p.parse)(location.search.slice(1))||{},t.htmlOrigBgColor="",t.state={tab:"appInfo",selectAppVersion:"",showDeploy:!1},t.appId=t.props.match.params.appId,t.appStore=new E.default,t.versionStore=new b.default,t}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.fixBodyColor(),this.getData()}},{key:"componentWillUnmount",value:function(){document.querySelector("html").style.backgroundColor=this.htmlOrigBgColor}},{key:"getData",value:function(){var e=this;this.appStore.fetchDetail({app_id:this.appId}),this.versionStore.fetchList({app_id:this.appId,status:"active"}).then((function(){var t=(0,d.default)(e.versionStore,"list.data[0].version_id","");e.setState({selectAppVersion:t})}))}},{key:"fixBodyColor",value:function(){var e=document.querySelector("html");this.htmlOrigBgColor=window.getComputedStyle(e).backgroundColor,e.style.backgroundColor="white"}},{key:"renderAppFilePreview",value:function(){var e=this.state.selectAppVersion;return f.default.createElement(P.default,{versionId:e,appId:this.appId})}},{key:"renderKeywords",value:function(){var e=this.appStore.detail.keywords,a=void 0===e?"":e;return a=a.split(",").map((function(e){return e.trim()})).filter(Boolean),f.default.createElement("div",{className:A.default.keywords},f.default.createElement("div",{className:"h6 margin-b12"},t("KEYWORDS")),f.default.createElement("div",null,0===a.length?t("NONE"):a.map((function(e,t){return f.default.createElement(y.Tag,{key:t,type:"secondary"},e)}))))}},{key:"renderDeployButton",value:function(){return f.default.createElement("div",{className:A.default.deployButton},f.default.createElement(y.Button,{onClick:this.handleDeploy,type:"control"},t("INSTALL")))}},{key:"renderContent",value:function(){var e=this.state.tab,a=this.appStore,r=a.detail,n=a.isLoading,o=this.versionStore.list.data;return n?f.default.createElement(y.Loading,{className:A.default.loading}):f.default.createElement(y.Tabs,{className:"tabs-new",activeName:e,onChange:this.handleTabChange},f.default.createElement(C,{label:t("APP_INFORMATION"),name:"appInfo"},this.renderDeployButton(),f.default.createElement(y.Columns,null,f.default.createElement(y.Column,{className:"is-8"},f.default.createElement(S.default,{app:r,versions:(0,m.toJS)(o)})),f.default.createElement(y.Column,null,f.default.createElement(O.default,{app:r})))),f.default.createElement(C,{label:t("APP_DETAILS"),name:"appDetails"},this.renderDeployButton(),f.default.createElement(y.Columns,null,f.default.createElement(y.Column,{className:"is-8"},this.renderAppFilePreview()),f.default.createElement(y.Column,null,f.default.createElement("div",{className:"h6 margin-b12"},t("VERSIONS")),f.default.createElement(g.default,{value:this.state.selectAppVersion,options:this.versionOptions,onChange:this.handleChangeAppVersion}),this.renderKeywords()))))}},{key:"render",value:function(){return f.default.createElement("div",{className:A.default.main},f.default.createElement(_.default,{className:A.default.banner,detail:this.appStore.detail,onBack:this.handleBack}),f.default.createElement("div",{className:A.default.content},this.renderContent()))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"loggedIn",get:function(){return Boolean(globals.user)}},{key:"versionOptions",get:function(){return this.versionStore.list.data.map((function(e){var a=e.version_id,r=e.name,n=e.create_time;return{label:r,description:(0,v.default)(n).format(t("YYYY-MM-DD")),value:a}}))}}]),r}(f.default.Component))||o)||o)||o;a.default=k},3601:function(e,t,a){e.exports={content:"uJVHweBS4HFTAnstlHzPK",loading:"-nONwbyGrLVYpoYF4eIXE",deployButton:"_1yBg2rAxqm_04YoXJqaCps",keywords:"_3SRHnOfu9lHMF1zKo6bTo7",deployModal:"_3IC68-TSj3egguvt1hSY-g"}},3602:function(e,a,r){"use strict";var n=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,l=n(r(49)),u=n(r(21)),c=n(r(50)),i=n(r(56)),s=n(r(12)),f=n(r(13)),d=n(r(19)),p=n(r(20)),m=n(r(18)),h=n(r(0)),v=n(r(16)),y=r(70),g=r(25),b=n(r(814)),E=n(r(862)),_=n(r(832)),S=n(r(1324)),P=n(r(1325)),O=n(r(1172)),w=r(37),A=r(279),R=n(r(3603)),C=n(r(3605));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var I=(0,y.inject)("rootStore")(o=(0,y.observer)(o=function(e){(0,d.default)(n,e);var a,r=N(n);function n(e){var t;(0,s.default)(this,n),(t=r.call(this,e)).handleOk=function(){var e=t.formRef.current;e&&e.validate((function(){var e=t.state.formData,a=e.cluster,r=e.workspace,n=e.namespace,o=(0,i.default)(e,["cluster","workspace","namespace"]);t.appStore.deploy(o,{cluster:a,namespace:n,workspace:r}).then((function(){t.routing.push("/".concat(r,"/clusters/").concat(a,"/projects/").concat(n,"/applications/template"))}))}))},t.handlePrev=function(){t.state.currentStep<=0?t.routing.push("/apps/".concat(t.appId)):t.setState((function(e){var t=e.currentStep;return{currentStep:Math.max(0,t-1)}}))},t.handleNext=function(){var e=t.formRef.current;e&&e.validate((function(){t.setState((function(e){var a=e.currentStep;return{currentStep:Math.min(t.steps.length-1,a+1)}}))}))},t.appId=t.props.match.params.appId,t.appStore=new E.default,t.versionStore=new b.default,t.fileStore=new _.default;var a=(0,A.parse)(location.search.slice(1))||{},o=a.workspace,l=a.cluster,u=a.namespace;return t.state={currentStep:0,formData:{app_id:t.appId,workspace:o,cluster:l,namespace:u}},t.formRef=h.default.createRef(),t}return(0,f.default)(n,[{key:"componentDidMount",value:function(){this.fixBodyColor(),this.getData()}},{key:"componentWillUnmount",value:function(){document.querySelector("html").style.backgroundColor=this.htmlOrigBgColor}},{key:"fixBodyColor",value:function(){var e=document.querySelector("html");this.htmlOrigBgColor=window.getComputedStyle(e).backgroundColor,e.style.backgroundColor="white"}},{key:"getData",value:(a=(0,c.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.appStore.fetchDetail({app_id:this.appId}),this.versionStore.fetchList({app_id:this.appId,status:"active"})]);case 2:return t=(0,v.default)(this.versionStore,"list.data[0].version_id",""),a=this.appStore.detail.name,e.next=6,this.fileStore.fetch({version_id:t});case 6:this.setState({formData:D(D({},this.state.formData),{},{name:"".concat(a.slice(0,7).toLowerCase().replaceAll(" ","-"),"-").concat((0,w.generateId)()),version_id:t})});case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderForm",value:function(){var e=this.appStore.isLoading,t=this.state,a=t.formData,r=t.currentStep;if(e)return h.default.createElement(g.Loading,{className:C.default.loading});var n=this.steps[r],o=n.component,l={formData:a,fromStore:!0,versionStore:this.versionStore,fileStore:this.fileStore,appId:this.appId};return n.isForm?l.formRef=this.formRef:l.ref=this.formRef,h.default.createElement("div",{className:C.default.form},h.default.createElement(o,l))}},{key:"renderControl",value:function(){var e=this.state.currentStep,a=this.steps.length-1;return h.default.createElement("div",{className:C.default.control},e<a?h.default.createElement(g.Button,{type:"control",onClick:this.handleNext},t("NEXT")):h.default.createElement(g.Button,{type:"control",onClick:this.handleOk,loading:this.appStore.isSubmitting},t("INSTALL")))}},{key:"renderSteps",value:function(){return h.default.createElement("div",{className:C.default.steps},h.default.createElement(R.default,{steps:this.steps,current:this.state.currentStep}))}},{key:"render",value:function(){return h.default.createElement("div",{className:C.default.main},h.default.createElement(O.default,{className:C.default.banner,detail:this.appStore.detail,onBack:this.handlePrev}),h.default.createElement("div",{className:C.default.content},this.renderSteps(),h.default.createElement(g.Columns,{className:C.default.formWrapper},h.default.createElement(g.Column,null,this.renderForm()),h.default.createElement(g.Column,{className:"is-narrow"},this.renderControl()))))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"steps",get:function(){return[{title:"BASIC_INFORMATION",component:S.default,required:!0,isForm:!0},{title:"APP_SETTINGS",component:P.default,required:!0}]}}]),n}(h.default.Component))||o)||o;a.default=I},3603:function(e,a,r){"use strict";var n=r(72),o=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=o(r(21)),u=o(r(12)),c=o(r(13)),i=o(r(19)),s=o(r(20)),f=o(r(18)),d=n(r(0)),p=o(r(3)),m=o(r(3604));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,i.default)(r,e);var a=h(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.steps,r=e.current;return d.default.createElement("div",{className:m.default.wrapper},a.map((function(e,a){var n;return d.default.createElement("div",{key:e.title},d.default.createElement("span",{className:(0,p.default)(m.default.indicator,(n={},(0,l.default)(n,m.default.fullfill,r>a),(0,l.default)(n,m.default.current,r===a),(0,l.default)(n,m.default.pending,r<a),n))}),d.default.createElement("span",null,t(e.title)))})))}}]),r}(d.Component);a.default=v},3604:function(e,t,a){e.exports={wrapper:"Y5RrUK_xRwzLBXP7b4wNW",indicator:"_1FKWzW8qT1cQbaCjQoa6HO",pending:"_3Aj1pxkr13ewtVnzcLzica",current:"_2-0FeelJD2upMaLWZeGPHm",fullfill:"_2MILhGOWZLoShuLJpQwqV-"}},3605:function(e,t,a){e.exports={content:"Rx21TJ4kQ4AHN0wB_1xaL",formWrapper:"_1T4ccUObh8ov73OgR9Y5AA",form:"fwnw9pZLnYTwz3TflYqU0",steps:"C73-ZODA7sY1W87p3b2sD",control:"a5AhMxg9LLqnHWgTiJgXV",loading:"CLdNUMYL7QR1yBzJTAT1e"}},3606:function(e,a,r){"use strict";var n=r(6),o=r(72);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,u=n(r(12)),c=n(r(13)),i=n(r(19)),s=n(r(20)),f=n(r(18)),d=o(r(0)),p=r(70),m=r(25),h=r(634),v=r(656),y=n(r(3607));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var b=(0,p.inject)("rootStore")(l=(0,p.observer)(l=function(e){(0,i.default)(r,e);var a=g(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.match,r=e.route,n=e.location;return d.default.createElement("div",{className:"ks-page-body"},d.default.createElement("div",{className:"ks-page-side"},d.default.createElement("div",{className:y.default.titleWrapper},d.default.createElement("div",{className:y.default.icon},d.default.createElement(m.Icon,{name:"openpitrix",size:40,type:"light"})),d.default.createElement("div",{className:y.default.text},d.default.createElement("div",{className:"h6"},t("APP_STORE_MANAGEMENT")))),d.default.createElement(v.Nav,{className:"ks-page-nav",navs:globals.app.getManageAppNavs(),location:n,match:a})),d.default.createElement("div",{className:"ks-page-main"},(0,h.renderRoutes)(r.routes)))}}]),r}(d.Component))||l)||l;a.default=b},3607:function(e,t,a){e.exports={wrapper:"_3CjyBOc6MtUc3tOGpu0rmE",main:"_37MyL6XF_OTJ5csJbG7OiC",navWrapper:"_2XSiDzIxtGT0NQq4xNrMS-",nav:"_3NHNPL-4KFqOvgDLrzNkms",cards:"_3gJVHl1IM_wXf3rrQUnoMJ",title:"_2pd0APMujbu7MFH9I5-hJ3",create:"_2w1AZeyUuVC287wAcWfUAx",total:"_29cGBQLmdHHHGFNvtfS9Ak",noData:"_1oOCw-f7A1ptZyAZh0564x",loading:"AR1qcPUAMs-ugnyCbrI37",titleWrapper:"RcVvB9p7wXf8dQKHVwfIU",icon:"_3jhYdCSN9a0_Uv3C64WaJH",text:"CMKjRYS0LImqebd3Ly4fV"}},3608:function(e,a,r){"use strict";var n=r(6),o=r(72);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,u=n(r(21)),c=n(r(71)),i=n(r(12)),s=n(r(13)),f=n(r(19)),d=n(r(20)),p=n(r(18)),m=n(r(0)),h=n(r(728)),v=o(r(726)),y=n(r(729)),g=n(r(724)),b=n(r(925)),E=r(37),_=r(813),S=n(r(1171));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var A=(0,v.default)({store:new S.default,module:"apps",name:"APP",rowKey:"app_id"})(l=function(e){(0,f.default)(r,e);var a=w(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=a.call.apply(a,[this].concat(o))).getColumns=function(){return[{title:t("NAME"),dataIndex:"name",width:"30%",render:function(e,t){return m.default.createElement(b.default,{to:"/apps-manage/store/".concat(t.app_id),avatar:t.icon,iconLetter:e,iconSize:40,title:e,desc:t.description})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"10%",render:function(e){return m.default.createElement(y.default,{type:e,name:(0,_.transferAppStatus)(e)})}},{title:t("WORKSPACE"),dataIndex:"isv",isHideable:!0,width:"10%"},{title:t("LATEST_VERSION"),dataIndex:"latest_app_version.name",isHideable:!0,width:"16%"},{title:t("APP_CATEGORY"),dataIndex:"category_set",isHideable:!0,width:"17%",render:function(e){return(0,_.getAppCategoryNames)(e)}},{title:t("UPDATE_TIME_TCAP"),dataIndex:"status_time",isHideable:!0,width:"17%",render:function(e){return(0,E.getLocalTime)(e).fromNow()}}]},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return m.default.createElement(v.ListPage,(0,c.default)({},this.props,{noWatch:!0}),m.default.createElement(g.default,(0,c.default)({},a,{title:t("APPS"),description:t("APP_STORE_DESC")})),m.default.createElement(h.default,(0,c.default)({},r,{tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"keyword"})))}},{key:"itemActions",get:function(){return[]}},{key:"tableActions",get:function(){return O(O({},this.props.tableProps.tableActions),{},{onCreate:null,selectActions:[]})}}]),r}(m.default.Component))||l;a.default=A},3609:function(e,a,r){"use strict";var n=r(6),o=r(72);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,u=n(r(71)),c=n(r(21)),i=n(r(12)),s=n(r(13)),f=n(r(19)),d=n(r(20)),p=n(r(18)),m=n(r(0)),h=r(5),v=r(25),y=n(r(728)),g=o(r(726)),b=n(r(724)),E=n(r(925)),_=n(r(1171)),S=n(r(1119)),P=n(r(3610)),O=n(r(3612));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=(0,g.default)({store:new _.default,module:"apps",name:"APP",rowKey:"app_id"})(l=function(e){(0,f.default)(r,e);var a=R(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=a.call.apply(a,[this].concat(o))).categoryStore=new S.default,e.state={selectCategoryId:"ctg-uncategorized"},e.getData=function(t){e.props.store.fetchList(A({category_id:e.state.selectCategoryId,status:"active"},t))},e.hadnleSelectCategory=function(t){e.state.selectCategoryId!==t&&e.setState({selectCategoryId:t},(function(){e.clearTableSearch()}))},e.clearTableSearch=function(){var t=e.props.tableProps,a=t.tableActions,r=t.searchType;a.onFetch((0,c.default)({},r,""),!0)},e.getColumns=function(){return[{title:t("NAME"),dataIndex:"app_id",width:"50%",render:function(e,t){return m.default.createElement(E.default,{to:"/apps/".concat(e),avatarType:"appIcon",avatar:t.icon,iconLetter:t.name,iconSize:40,title:t.name,desc:t.description})}},{title:t("WORKSPACE"),dataIndex:"isv",isHideable:!0,width:"25%"},{title:t("LATEST_VERSION"),dataIndex:"latest_app_version.name",isHideable:!0,width:"25%"}]},e}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e,t){t.selectCategoryId!==this.state.selectCategoryId&&this.getData()}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps,n=this.state.selectCategoryId;return m.default.createElement(g.ListPage,(0,u.default)({},this.props,{getData:this.getData,noWatch:!0}),m.default.createElement(b.default,(0,u.default)({},a,{icon:"tag",title:t("APP_CATEGORY_PL"),description:t("APP_CATEGORIES_DESC")})),m.default.createElement(v.Columns,{className:O.default.main},m.default.createElement(v.Column,{className:"is-3"},m.default.createElement(P.default,{store:this.categoryStore,selectedId:n,onSelect:this.hadnleSelectCategory})),m.default.createElement(v.Column,null,m.default.createElement(y.default,(0,u.default)({},r,{tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),emptyProps:this.emptyProps,searchType:"keyword"})))))}},{key:"tableActions",get:function(){var e=this,a=this.props,r=a.trigger;return A(A({},a.tableProps.tableActions),{},{onCreate:null,selectActions:[{key:"adjust",type:"primary",text:t("CHANGE_CATEGORY"),onClick:function(){return r("openpitrix.category.ajust",{categoryId:e.state.selectCategoryId,categories:(0,h.toJS)(e.categoryStore.list.data),success:function(){e.categoryStore.fetchList({noLimit:!0,statistics:!0}),e.getData()}})}}]})}},{key:"emptyProps",get:function(){return{desc:t("APP_CATEGORY_EMPTY_DESC")}}}]),r}(m.default.Component))||l;a.default=C},3610:function(e,a,r){"use strict";var n=r(6),o=r(72);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,u=n(r(12)),c=n(r(13)),i=n(r(19)),s=n(r(20)),f=n(r(18)),d=o(r(0)),p=r(70),m=r(25),h=n(r(741)),v=r(635),y=n(r(3611)),g=n(r(1523));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=(0,p.inject)("rootStore")(l=(0,p.observer)(l=(0,v.trigger)(l=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).store=e.props.store,e.getData=function(){return e.store.fetchList({noLimit:!0,statistics:!0})},e.isSelectedCategory=function(e,t){return t?e.category_id===t:"ctg-uncategorized"===e.category_id},e.showEdit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.store.list.data.map((function(e){return e.name}));e.trigger("openpitrix.category.edit",{detail:t,names:a,success:function(){e.getData(),e.props.onSelect("")}})},e.showDelete=function(t){e.trigger("openpitrix.category.delete",{detail:t,success:function(){e.getData(),e.props.onSelect("")}})},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this,a=this.props,r=a.selectedId,n=a.onSelect,o=this.store.list;return d.default.createElement(m.Loading,{spinning:o.isLoading},d.default.createElement(h.default,{className:g.default.categories},d.default.createElement("div",{className:g.default.title},d.default.createElement("label",null,t("ALL_CATEGORIES_VALUE",{value:o.total})),d.default.createElement("label",{className:g.default.add},d.default.createElement(m.Icon,{onClick:this.showEdit,name:"add",size:20}))),d.default.createElement("ul",null,o.data.map((function(t){return d.default.createElement(y.default,{key:t.category_id,data:t,onSelect:n,onEdit:e.showEdit,onDelete:e.showDelete,isSelected:e.isSelectedCategory(t,r)})})))))}}]),r}(d.Component))||l)||l)||l;a.default=E},3611:function(e,a,r){"use strict";var n=r(72),o=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=o(r(21)),u=o(r(12)),c=o(r(13)),i=o(r(19)),s=o(r(20)),f=o(r(18)),d=n(r(0)),p=o(r(3)),m=r(25),h=o(r(1523));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=function(e){(0,i.default)(r,e);var a=v(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleSelect=function(){var t=e.props;(0,t.onSelect)(t.data.category_id)},e.handleEdit=function(t){t.stopPropagation();var a=e.props;(0,a.onEdit)(a.data)},e.handleDelete=function(t){t.stopPropagation();var a=e.props;(0,a.onDelete)(a.data)},e}return(0,c.default)(r,[{key:"render",value:function(){var e,a=this.props,r=a.data,n=a.isSelected;return d.default.createElement("li",{onClick:this.handleSelect,className:(0,p.default)((e={},(0,l.default)(e,h.default.hasAction,"ctg-uncategorized"!==r.category_id),(0,l.default)(e,h.default.active,n),e))},d.default.createElement(m.Icon,{className:h.default.icon,name:["uncategorized",""].includes(r.description)?"tag":r.description,size:16,clickable:!0}),t("APP_CATE_".concat(r.name.toUpperCase().replace(/[^A-Z]+/g,"_")),{defaultValue:r.name}),d.default.createElement("label",{className:h.default.number},r.app_total||0),d.default.createElement("label",{className:h.default.actions},d.default.createElement(m.Icon,{onClick:this.handleEdit,name:"pen",size:16,clickable:!0}),d.default.createElement(m.Icon,{onClick:this.handleDelete,name:"trash",size:16,clickable:!0})))}}]),r}(d.PureComponent);a.default=y},3612:function(e,t,a){e.exports={main:"_1VZLjYbVOle4gGUzMReD6_"}},3613:function(e,a,r){"use strict";var n=r(6),o=r(72);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,u=n(r(71)),c=n(r(49)),i=n(r(21)),s=n(r(50)),f=n(r(12)),d=n(r(13)),p=n(r(19)),m=n(r(20)),h=n(r(18)),v=n(r(0)),y=n(r(729)),g=n(r(728)),b=o(r(726)),E=n(r(724)),_=n(r(925)),S=n(r(3614)),P=r(787),O=r(37),w=r(813),A=n(r(302)),R=n(r(3615));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var N=(0,b.default)({store:new S.default,module:"apps",name:"APP_REVIEW",rowKey:"version_id"})(l=function(e){(0,p.default)(r,e);var a=D(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("/apps-manage/reviews/".concat(t))},e.getData=function(){var t=(0,s.default)(c.default.mark((function t(a){var r;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=P.REVIEW_QUERY_STATUS[e.type],t.next=3,e.props.store.fetchReviewList(k({status:r,queryApp:!0},a));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showReview=function(t){return e.props.trigger("openpitrix.template.review",{detail:t,type:e.type,success:e.getData,onReject:function(){return e.props.trigger("openpitrix.template.reject",{detail:t,type:e.type,success:e.getData})}})},e.getAppIcon=function(t){return((0,A.default)(e.props.store.list.apps,{app_id:t})||{}).icon},e.getAppISV=function(t){return((0,A.default)(e.props.store.list.apps,{app_id:t})||{}).isv},e.getColumns=function(){return[{title:t("NAME"),dataIndex:"review_id",width:"30%",render:function(t,a){return v.default.createElement(_.default,{avatarClass:R.default.appIcon,avatar:e.getAppIcon(a.app_id),iconLetter:a.app_name,iconSize:40,title:a.app_name,desc:a.version_name||"-",onClick:function(){return e.showReview(a)}})}},{title:t("WORKSPACE"),dataIndex:"app_id",isHideable:!0,width:"15%",render:function(t){return e.getAppISV(t)}},{title:t("OPERATOR"),dataIndex:"reviewer",isHideable:!0,width:"15%"},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"15%",render:function(e){var a=(0,w.transferReviewStatus)(e);return v.default.createElement(y.default,{className:R.default.status,type:a,name:t("APP_STATUS_".concat(a.toUpperCase().replace(/-/g,"_")))})}},{title:t("UPDATE_TIME_TCAP"),dataIndex:"status_time",isHideable:!0,width:"15%",render:function(e){return(0,O.getLocalTime)(e).fromNow()}}]},e}return(0,d.default)(r,[{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return v.default.createElement(b.ListPage,(0,u.default)({},this.props,{getData:this.getData,noWatch:!0}),v.default.createElement(E.default,(0,u.default)({},a,{tabs:this.tabs,icon:"safe-notice",title:t("APP_REVIEW"),description:t("APP_REVIEW_DESC")})),v.default.createElement(g.default,(0,u.default)({},r,{tableActions:this.tableActions,itemActions:this.itemActions,emptyProps:this.emptyProps,columns:this.getColumns(),searchType:"keyword"})))}},{key:"type",get:function(){return this.props.match.params.type}},{key:"tabs",get:function(){return{value:this.type,onChange:this.handleTabChange,options:[{value:"unprocessed",label:t("NEW_SUBMIT")},{value:"processed",label:t("COMPLETED")},{value:"all",label:t("ALL")}]}}},{key:"itemActions",get:function(){return[{key:"handle",icon:"eye",text:t("VIEW_DETAILS"),onClick:this.showReview}]}},{key:"tableActions",get:function(){return k(k({},this.props.tableProps.tableActions),{},{onCreate:null,selectActions:[]})}},{key:"emptyProps",get:function(){return{icon:"safe-notice",title:t("APP_REVIEW_".concat(this.type.toUpperCase(),"_EMPTY_DESC"))}}}]),r}(v.default.Component))||l;a.default=N},3614:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o,l,u,c=r(a(49)),i=r(a(56)),s=r(a(50)),f=r(a(91)),d=r(a(12)),p=r(a(13)),m=r(a(135)),h=r(a(19)),v=r(a(20)),y=r(a(18)),g=r(a(74)),b=(r(a(92)),a(5)),E=r(a(16)),_=r(a(281)),S=a(37);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var O=(n=function(e){(0,h.default)(r,e);var t,a=P(r);function r(){var e;(0,d.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).resourceName="reviews",e.sortKey="status_time",(0,f.default)(e,"list",o,(0,m.default)(e)),(0,f.default)(e,"handle",l,(0,m.default)(e)),(0,f.default)(e,"queryApps",u,(0,m.default)(e)),e}return(0,p.default)(r,[{key:"fetchReviewList",value:(t=(0,s.default)(c.default.mark((function e(){var t,a,r,n,o=arguments;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=o.length>0&&void 0!==o[0]?o[0]:{}).queryApp,a=(0,i.default)(t,["queryApp"]),e.next=3,this.fetchList(a);case 3:return this.list.isLoading=!0,r=(0,E.default)(this,"list.data",[]).map((function(e){return e.app_id})),e.next=7,this.queryApps((0,_.default)(r).join("|"));case 7:n=e.sent,Object.assign(this.list,{apps:(0,E.default)(n,"items",[]),isLoading:!1});case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(r(a(844)).default),o=(0,g.default)(n.prototype,"list",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],apps:[],page:0,limit:10,total:0,reverse:!1,filters:{},isLoading:!0,keyword:"",selectedRowKeys:[]}}}),l=(0,g.default)(n.prototype,"handle",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,s.default)(c.default.mark((function t(){var a,r,n,o,l,u=arguments;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=u.length>0&&void 0!==u[0]?u[0]:{},r=a.app_id,n=a.version_id,o=(0,i.default)(a,["app_id","version_id"]),l=e.getUrl({app_id:r,version_id:n,name:"action"}),t.next=4,e.submitting(request.post(l,o));case 4:case"end":return t.stop()}}),t)})))}}),(0,g.default)(n.prototype,"fetchReviewList",[b.action],Object.getOwnPropertyDescriptor(n.prototype,"fetchReviewList"),n.prototype),u=(0,g.default)(n.prototype,"queryApps",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(c.default.mark((function t(a){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get(e.getUrl({name:"apps"}),{conditions:(0,S.getFilterString)({app_id:a})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),n);t.default=O},3615:function(e,t,a){e.exports={header:"_1iwoJLJ6XPqA1AUDjjJQV3",banner:"_2oFZSx-DIvZDXUY8fW8E1h",nav:"f70VhkFjP2GPOJrI4GCPp",status:"_3sv36FzPV-5lJk_Osit3fy"}},3616:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=[{path:"/apps-manage/store/:appId",component:r(a(3617)).default}];t.default=n},3617:function(e,a,r){"use strict";var n=r(6);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,l=n(r(71)),u=n(r(12)),c=n(r(13)),i=n(r(19)),s=n(r(20)),f=n(r(18)),d=n(r(0)),p=r(5),m=r(70),h=n(r(16)),v=r(25),y=n(r(293)),g=r(37),b=r(635),E=r(813),_=n(r(862)),S=n(r(814)),P=n(r(815)),O=n(r(3618)),w=n(r(3621));function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var R=(0,m.inject)("rootStore")(o=(0,m.observer)(o=(0,b.trigger)(o=function(e){(0,i.default)(r,e);var a=A(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=a.call.apply(a,[this].concat(o))).store=new _.default,e.versionStore=new S.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){var a=e.store.detail;return"active"===a.status?[{key:"suspend",type:"control",icon:"sort-descending",text:t("SUSPEND"),onClick:function(){return e.trigger("openpitrix.template.action",{detail:a,handleType:"suspend",success:e.fetchData})}}]:[{key:"recover",type:"control",icon:"sort-ascending",text:t("RELEASE"),onClick:function(){return e.trigger("openpitrix.template.action",{detail:a,handleType:"recover",success:e.fetchData})}}]},e.getAttrs=function(){var a=(0,p.toJS)(e.store.detail),r=(0,h.default)(a,"create_time",new Date);return[{name:t("APP_ID"),value:a.app_id},{name:t("STATUS"),value:(0,E.transferAppStatus)(a.status)},{name:t("CATEGORY"),value:(0,E.getAppCategoryNames)((0,h.default)(a,"category_set",[]))},{name:t("TYPE"),value:(0,E.getVersionTypesName)((0,h.default)(a,"app_version_types",""))},{name:t("WORKSPACE"),value:(0,h.default)(a,"isv","-")},{name:t("CREATION_TIME_TCAP"),value:(0,g.getLocalTime)(r).format("YYYY-MM-DD HH:mm:ss")}]},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.fetchData(),this.store.isAdmin=!0}},{key:"render",value:function(){var e={detailStore:this.store,versionStore:this.versionStore};if(this.store.isLoading&&!this.store.detail.name)return d.default.createElement(v.Loading,{className:"ks-page-loading"});var a=this.store.detail,r={icon:d.default.createElement("label",{className:w.default.icon},d.default.createElement(y.default,{iconLetter:a.name,src:a.icon,alt:""})),module:this.module,authKey:this.authKey,name:(0,g.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APPS"),url:this.listUrl}]};return d.default.createElement(P.default,(0,l.default)({stores:e,routes:O.default},r))}},{key:"module",get:function(){return this.store.module}},{key:"authKey",get:function(){return"apps"}},{key:"name",get:function(){return"APP"}},{key:"listUrl",get:function(){return"/apps-manage/store"}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(d.default.Component))||o)||o)||o;a.default=R},3618:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(634),o=r(a(3619)),l=r(a(1470)),u=r(a(1472)),c=r(a(3620)),i="/apps-manage/store/:appId",s=[{path:"".concat(i,"/versions"),title:"VERSIONS",component:o.default,exact:!0},{path:"".concat(i,"/app-information"),title:"APP_INFORMATION",component:l.default,exact:!0},{path:"".concat(i,"/audit-records"),title:"APP_REVIEW",component:u.default,exact:!0},{path:"".concat(i,"/app-instances"),title:"APP_INSTANCES",component:c.default,exact:!0},(0,n.getIndexRoute)({path:i,to:"".concat(i,"/versions"),exact:!0})];t.default=s},3619:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=r(a(12)),l=r(a(13)),u=r(a(19)),c=r(a(20)),i=r(a(18)),s=r(a(0)),f=a(70),d=r(a(1474));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=(0,f.inject)("detailStore","versionStore")(n=function(e){(0,u.default)(a,e);var t=p(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.detailStore,a=e.versionStore,r=e.match;return s.default.createElement(d.default,{appStore:t,versionStore:a,match:r})}}]),a}(s.default.Component))||n;t.default=m},3620:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(12)),o=r(a(13)),l=r(a(19)),u=r(a(20)),c=r(a(18)),i=r(a(0)),s=r(a(1157));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var d=function(e){(0,l.default)(a,e);var t=f(a);function a(){return(0,n.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props.match.params.appId;return i.default.createElement(s.default,{appId:e})}}]),a}(i.default.Component);t.default=d},3621:function(e,t,a){e.exports={icon:"_1yAXNsXzfWL_WfmUFBRjzZ"}},722:function(e,t,a){"use strict";var r=a(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(634),o=r(a(3596)),l=function(){return(0,n.renderRoutes)(o.default)};t.default=l}}]);